<a id="StartPage"></a>
# FreePlayGame
__Проект задуман для того, чтоб научиться работать с аккаунтами пользователей.__

__Основные цели:__
 - научиться создавать базу данных
 - подключаться к базе данных
 - создавать аккаунт при введении данных игроком в соответствующие поля
 - запускать игру под конкретного пользователя, ранее внесенного в базу данных
 - сохранять параметры в базу под конкретного пользователя (количество набранных очков за игру)

__1. Описание игрового процесса__
Игровой процесс достаточно прост: игроку под управление дается условный персонаж (капсула синего цвета), управление осуществляется клавишами WASD на клавиатуре. При старте игры запускается сопрограмма, которая циклично выполняет стрельбу игрока. Стреляет персонаж каждые 2 секунды игрового времени, если в радиусе поражения есть вражеский персонаж (капсула красного цвета). Если вражеского персонажа нет в радиусе поражения - стрельба не осуществляется. Вражеские персонажи наносят урон игроку при соприкосновении с ним. Цель - убить как можно больше вражеских персонажей до того, как игрок погибнет.

![GameProcess](https://user-images.githubusercontent.com/47788812/194041606-52942610-740d-4939-90f7-2423bdfa3b8e.PNG)
_Скриншот игрового процесса_

В правом верхнем углу экрана игрок может видеть сколько на текущий момент уже убито вражеских персонажей (набрано очков). Внизу экрана игрок может следить за состоянием здоровья своего персонажа.

Если игрок погибает, появляется окно, которое показывает, сколько в итоге заработано очков за игровую сессию. Так же есть две кнопки: перезапуск уровня и выход в главное меню. При нажатии на любую из них будет осуществлено взаимодействие с базой данных, с целью обновить в ней показатель набранных очков.

![DeathBoard](https://user-images.githubusercontent.com/47788812/194042360-0e109a0b-5958-4afe-a279-5a4bbbca90df.PNG)
_Скриншот окна после смерти игрока_

__2. Взаимодействие с Базой Данных__

Работа осуществлена на localhost с использованием MAMP PRO и phpMyAdmin для работы с таблицами.
Когда игрок запускает игру, перед ним появляется окно ввода имени пользователя и пароля. 

![LoginWindow](https://user-images.githubusercontent.com/47788812/194043423-763cdd21-11eb-45b5-af9a-aa5a5557ef49.PNG)
_Скриншот окна ввода логина и пароля_

В данном описании пройдем по пути, когда у игрока еще нет аккаунта. Тогда игрок может нажать на синюю строчку с текстом __"Don't you have an account?"__. Таким образом игрок попадет на другое окно - окно регистрации.

![CreateAccountWindow](https://user-images.githubusercontent.com/47788812/194043788-6e807468-23d3-4c02-975a-3d93626cd887.PNG)
_Скриншот создания аккаунта пользователя_

Здесь игроку предлагается придумать себе логин и пароль, по нажатию клавиши __Create__ информация из полей для ввода будет отправлена на сервер.

![CodeRegistration](https://user-images.githubusercontent.com/47788812/194044560-0f76bfdc-39ca-4a15-853f-08c098748e5c.PNG)
_Код отправки запроса в базу данных со стороны Unity_

После того, как запрос со стороны Unity ушел, он попадает в сферу PHP, где и происходит взаимодействие с базой данных. 

![PHPRegister](https://user-images.githubusercontent.com/47788812/194045264-ba7a4447-90b1-46e9-991e-90c2c7929c45.PNG)
_Код php регистрации пользователя_

Полученные от Unity данные имени и пароля пользователя обрабатываются и направляются в подготовленную для данной игры таблицу пользователей. Таким образом таблица пополняется новым игроком, где ID пользователя автоматически увеличивается на единицу, а количество набранных очков присваивается по умолчанию - ноль. Имена пользователей так же настроены на уникальность, чтоб избежать одинаковых имен игроков.

![phpMyAdmin](https://user-images.githubusercontent.com/47788812/194046303-b1c0130c-d69e-4b97-bce5-36651253af74.PNG)
_Скриншот таблицы пользователей_

Когда игрок зарегистрировал свой аккаунт, перед ним открывается окно входа, где ему необходимо ввести свой логин и пароль. Тогда уже запрос от Unity выглядит похожим образом, а обработка на стороне PHP производит немного другие действия.

![LoginCode](https://user-images.githubusercontent.com/47788812/194047245-9e6f1d64-9f42-46df-9c18-2d09452f2f2c.PNG)
_Код отправки запроса в базу данных со стороны Unity_

![phpLogin](https://user-images.githubusercontent.com/47788812/194047292-db81ea37-5aa8-4d3b-9e27-7b2ee1e37cf9.PNG)
_Код php для входа в аккаунт пользователя_

Полученные от Unity данные имени и пароля пользователя обрабатываются и направляются в подготовленную для данной игры таблицу пользователей, где берут информацию из таблицы по имени пользователя и проверяют введенные игроком данные. Положительный ответ от запроса пропустит пользователя в игру. 

Сам же Unity запомнит, кто из пользователей сейчас находится в игре с помощью статического класса

![StaticClassDataBase](https://user-images.githubusercontent.com/47788812/194048025-e5585556-eb1c-45f1-ae95-14071aaf1019.PNG)
_Код статического класса для зранения информации об игроке_

Когда игрок погибает, нажимая любую из кнопок Рестарт или Выход, происходит запрос к базе данных со стороны Unity, где уже Unity передает информацию по имени и кол-ву набранных очков за игру.

![CodeSaveData](https://user-images.githubusercontent.com/47788812/194048546-701f9b53-a7e9-4f17-b14c-f1a59445a134.PNG)
_Код отправки запроса на сохранение данных в таблицу_

Со стороны PHP запрос же выглядит следующим образом:

![PHPSaveData](https://user-images.githubusercontent.com/47788812/194048871-4f3fb90c-6d17-498d-b1e1-a49e67f7d39d.PNG)
_Код php для сохранения данных_

Здесь уже получаем информацию из таблицы пользователей и сравниваем количество очков в таблице и полученное в текущий момент количество очков от Unity. Если же в таблице результат очков лучше нового результата, тогда выходим из запроса. Если же новый результат лучше, он перезаписывается в таблицу за пользователем. Теперь у данного пользователя новый рекорд.

__3. Заключение__
Более подробно со всеми сценариями можно ознакомиться в Assets. Все скрипты размещены в папке Scripts. Далее для удобства размещение файлов разделено по папкам в зависимости от их принадлежности.

Мне удалось лучше понять, как строится взаимодействие с базой данных на сервере, как можно такое взаимодействие применить в играх. На этом проект не заканчивается, есть цели расширять знания в этой области

[Вернуться к началу описания](#StartPage)